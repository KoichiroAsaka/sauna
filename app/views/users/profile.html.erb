<div class="container mt-5">
  <div class="card p-4 text-center shadow-lg">

    <!-- ✅ セクションタイトル -->
    <h2 class="mb-4">プロフィール</h2>

    <!-- ✅ プロフィール画像 -->
    <div class="d-flex flex-column align-items-center mb-3">
      <% if @user.profile_image.attached? %>
       <%= image_tag url_for(@user.profile_image),
                  class: "rounded-circle mb-2 shadow-sm",
                  width: 120, height: 120 %>
      <% else %>
       <%= image_tag "default-avatar.png",
                  class: "rounded-circle mb-2 shadow-sm",
                  width: 120, height: 120 %>
       <p class="text-muted mb-0">※アイコン未登録</p>
      <% end %>
    </div>

    <!-- ✅ 名前 -->
    <h4 class="mt-3 mb-2">名前</h4>
    <p class="fw-semibold"><%= @user.name.presence || "名前未設定" %></p>

    <!-- 自己紹介 -->
    <h4 class="mt-3 mb-2">自己紹介</h4>
    <p><%= @user.profile.presence || "自己紹介がまだありません。" %></p>

    <!-- 投稿一覧 -->
    <%= link_to "#{@user.name} さんの投稿一覧", posts_user_path(@user), class: "btn btn-outline-primary mt-3" %>

    <!-- フォロー／フォロー解除ボタン（他ユーザーの場合のみ） -->
    <% if current_user != @user %>
      <% if current_user.following?(@user) %>
        <%= button_to "フォロー解除",
                      relationship_path(user_id: @user.id),
                      method: :delete,
                      class: "btn btn-outline-danger w-100 mt-3" %>
      <% else %>
        <%= button_to "フォローする",
                      relationships_path(user_id: @user.id),
                      method: :post,
                      class: "btn btn-outline-primary w-100 mt-3" %>
      <% end %>
    <% end %>

    <!-- ✅ 本人のみ：編集・削除ボタン -->
    <% if @user == current_user %>
      <%= link_to "プロフィールを編集",
                  edit_profile_user_path(@user),
                  class: "btn btn-primary w-100 mt-4" %>

      <%= link_to "プロフィールを削除",
                  profile_user_path(@user),
                  method: :delete,
                  data: { confirm: "本当にプロフィールを削除しますか？" },
                  class: "btn btn-danger w-100 mt-3" %>
    <% end %>
  </div>
</div>
