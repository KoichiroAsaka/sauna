<div class="container text-center mt-5">
  <h3>モラルチェック</h3>

  <% @scenes.each do |scene| %>
    <div class="card mt-4 p-3">
      <!-- シーン内容 -->
      <p class="fs-5"><%= simple_format(scene.description) %></p>

      <% user_eval = @user_evaluations[scene.id] %>

      <!-- ✅ 評価ボタン（Good/Bad） -->
      <div class="d-flex mb-2">
        <%= button_to "Good 👍", scene_evaluations_path(scene, result: "Good"),
              method: :post,
              class: "btn me-2 #{user_eval&.result == 'Good' ? 'btn-success' : 'btn-outline-success'}",
              data: { turbo: false } %>

        <%= button_to "Bad 👎", scene_evaluations_path(scene, result: "Bad"),
              method: :post,
              class: "btn #{user_eval&.result == 'Bad' ? 'btn-danger' : 'btn-outline-danger'}",
              data: { turbo: false } %>
      </div>

      <% if user_eval&.result.present? %>
        <p>あなたの評価：<strong><%= user_eval.result %></strong></p>
      <% end %>

      <!-- ✅ コメント投稿フォーム -->
      <h6 class="mt-3">💬 コメントを投稿する</h6>
      <%= form_with model: Comment.new, url: scene_comments_path(scene), local: true do |f| %>
        <div class="mb-2">
          <%= f.text_area :content, rows: 2, class: "form-control", placeholder: "コメントを入力..." %>
        </div>
        <%= f.submit "投稿する", class: "btn btn-primary btn-sm" %>
      <% end %>

      <!-- ✅ 詳細ページリンク -->
      <%= link_to "みんなの意見", scene_path(scene), class: "btn btn-outline-secondary btn-sm mt-3" %>
    </div>
  <% end %>
</div>
